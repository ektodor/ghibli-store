import{P as E}from"./PaginationComponent-IlatARGI.js";import{_ as C,M as y,r as _,o as c,k as A,w,b as t,t as g,d as h,j as f,a,n as b,v as I,c as p,i as U,F as M}from"./index-CX6vVx-6.js";import{D as T}from"./DeleteModalComponent-C214MFat.js";var D={VITE_APP_API_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_API_NAME:"ektodorwang-api",BASE_URL:"/ghibli-store/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:x,VITE_APP_API_NAME:V}=D,R={data(){return{product:{},editModal:null}},methods:{openModal(){this.editModal.show()},createPrdouct(){this.product.imagesUrl=this.product.imagesUrl.filter(d=>d!==""),this.$http.post(`${x}/api/${V}/admin/product`,{data:this.product}).then(()=>{this.$emit("read-products"),this.editModal.hide(),this.imgModal.hide()}).catch(d=>{console.error(d.message),alert("新增失敗")})},updatePrdouct(){this.$http.put(`${x}/api/${V}/admin/product/${this.tempProduct.id}`,{data:this.product}).then(()=>{this.$emit("read-products"),this.editModal.hide(),this.imgModal.hide()}).catch(d=>{console.error(d.message),alert("更新失敗")})}},watch:{tempProduct(){this.product=JSON.parse(JSON.stringify(this.tempProduct)),this.product.imagesUrl||(this.product.imagesUrl=[])}},props:["tempProduct","isCreateModal"],emits:["edit-modal","read-products"],mounted(){this.editModal=new y(this.$refs.editModal),this.imgModal=new y(this.$refs.imgModal),this.$emit("edit-modal",this.editModal)}},S={ref:"editModal",class:"modal fade",id:"exampleModalToggle","aria-hidden":"true","aria-labelledby":"exampleModalToggleLabel",tabindex:"-1"},N={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-lg"},L={class:"modal-content"},O={class:"modal-header bg-secondary"},$={class:"modal-title fs-5",id:"exampleModalToggleLabel"},B=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),J={class:"modal-body"},q={class:"card mb-3 m-auto",style:{"max-width":"540px"}},j={class:"row g-0"},F={class:"col-md-4"},z=["src"],G={class:"col-md-8"},H={class:"card-body"},K=t("h5",{class:"card-title"},"主要圖片",-1),Q=t("label",{for:"imageUrl",class:"form-label card-text"},[t("small",{class:"text-muted"},"輸入圖片網址")],-1),W={class:"mb-3"},X=t("label",{for:"title",class:"form-label"},"標題",-1),Y={class:"row"},Z={class:"mb-3 col-md-6"},tt=t("label",{for:"category",class:"form-label"},"分類",-1),et={class:"mb-3 col-md-6"},ot=t("label",{for:"price",class:"form-label"},"單位",-1),lt={class:"row"},st={class:"mb-3 col-md-6"},dt=t("label",{for:"origin_price",class:"form-label"},"原價",-1),at={class:"mb-3 col-md-6"},it=t("label",{for:"price",class:"form-label"},"售價",-1),nt=t("hr",null,null,-1),rt={class:"mb-3"},ct=t("label",{for:"description",class:"form-label"},"產品描述",-1),mt={class:"mb-3"},ut=t("label",{for:"content",class:"form-label"},"說明內容",-1),pt={class:"mb-3"},_t={class:"form-check"},ht=t("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),bt=t("div",{class:"modal-footer"},[t("a",{class:"btn btn-primary","data-bs-target":"#exampleModalToggle2","data-bs-toggle":"modal"}," 編輯圖片 ")],-1),gt={ref:"imgModal",class:"modal fade",id:"exampleModalToggle2","aria-hidden":"true","aria-labelledby":"exampleModalToggleLabel2",tabindex:"-1"},ft={class:"modal-dialog modal-dialog-centered modal-lg"},vt={class:"modal-content"},Mt=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"exampleModalToggleLabel2"},"圖片編輯"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Pt={class:"modal-body d-flex flex-wrap justify-content-evenly"},yt={class:"row g-0"},xt=["src"],Vt={class:"card-body"},Ct=t("h5",{class:"card-title"},"補充圖片",-1),Ut=["for"],kt=t("small",{class:"text-muted"},"輸入圖片網址",-1),Et=[kt],At=["id","onUpdate:modelValue"],wt=["onClick"],It={class:"modal-footer"},Tt=t("a",{class:"btn btn-primary","data-bs-target":"#exampleModalToggle","data-bs-toggle":"modal"}," 返回 ",-1),Dt=t("button",{type:"submit",class:"btn btn-primary"},"儲存資料",-1);function Rt(d,e,n,k,o,i){const m=_("v-field"),u=_("error-message"),v=_("v-form");return c(),A(v,{onSubmit:e[10]||(e[10]=s=>n.isCreateModal?i.createPrdouct():i.updatePrdouct())},{default:w(({errors:s})=>[t("div",S,[t("div",N,[t("div",L,[t("div",O,[t("h1",$,g(n.isCreateModal?"新增產品":"編輯產品"),1),B]),t("div",J,[t("div",q,[t("div",j,[t("div",F,[t("img",{src:o.product.imageUrl,class:"img-fluid rounded-start",alt:"photo"},null,8,z)]),t("div",G,[t("div",H,[K,Q,h(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":e[0]||(e[0]=l=>o.product.imageUrl=l)},null,512),[[f,o.product.imageUrl]])])])])]),t("div",W,[X,a(m,{id:"title",name:"標題",rules:"required",class:b([{"is-invalid":s.標題},"form-control"]),type:"text",placeholder:"請輸入標題",modelValue:o.product.title,"onUpdate:modelValue":e[1]||(e[1]=l=>o.product.title=l)},null,8,["class","modelValue"]),a(u,{name:"標題",class:"invalid-feedback"})]),t("div",Y,[t("div",Z,[tt,a(m,{id:"category",name:"分類",rules:"required",class:b([{"is-invalid":s.分類},"form-control"]),type:"text",placeholder:"請輸入分類",modelValue:o.product.category,"onUpdate:modelValue":e[2]||(e[2]=l=>o.product.category=l)},null,8,["class","modelValue"]),a(u,{name:"分類",class:"invalid-feedback"})]),t("div",et,[ot,a(m,{id:"unit",name:"單位",rules:"required",class:b([{"is-invalid":s.單位},"form-control"]),type:"text",placeholder:"請輸入單位",modelValue:o.product.unit,"onUpdate:modelValue":e[3]||(e[3]=l=>o.product.unit=l)},null,8,["class","modelValue"]),a(u,{name:"單位",class:"invalid-feedback"})])]),t("div",lt,[t("div",st,[dt,a(m,{id:"origin_price",name:"原價",rules:"required",class:b([{"is-invalid":s.原價},"form-control"]),type:"number",min:"0",placeholder:"請輸入原價",modelValue:o.product.origin_price,"onUpdate:modelValue":e[4]||(e[4]=l=>o.product.origin_price=l),modelModifiers:{number:!0}},null,8,["class","modelValue"]),a(u,{name:"原價",class:"invalid-feedback"})]),t("div",at,[it,a(m,{id:"price",name:"售價",rules:"required",class:b([{"is-invalid":s.售價},"form-control"]),type:"number",min:"0",placeholder:"請輸入售價",modelValue:o.product.price,"onUpdate:modelValue":e[5]||(e[5]=l=>o.product.price=l),modelModifiers:{number:!0}},null,8,["class","modelValue"]),a(u,{name:"售價",class:"invalid-feedback"})])]),nt,t("div",rt,[ct,h(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入產品描述","onUpdate:modelValue":e[6]||(e[6]=l=>o.product.description=l)},`
              `,512),[[f,o.product.description]])]),t("div",mt,[ut,h(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入說明內容","onUpdate:modelValue":e[7]||(e[7]=l=>o.product.content=l)},`
              `,512),[[f,o.product.content]])]),t("div",pt,[t("div",_t,[h(t("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":e[8]||(e[8]=l=>o.product.is_enabled=l)},null,512),[[I,o.product.is_enabled]]),ht])])]),bt])])],512),t("div",gt,[t("div",ft,[t("div",vt,[Mt,t("div",Pt,[(c(!0),p(M,null,U(o.product.imagesUrl,(l,r)=>(c(),p("div",{class:"card mb-3",style:{width:"350px"},key:r},[t("div",yt,[t("img",{style:{"min-height":"200px"},src:l,class:"card-img-top",alt:"photo"},null,8,xt),t("div",Vt,[Ct,t("label",{for:"補充圖片-"+(r+1),class:"form-label card-text"},Et,8,Ut),h(t("input",{id:"補充圖片-"+(r+1),type:"text",class:"form-control mb-2",placeholder:"請輸入圖片連結","onUpdate:modelValue":P=>o.product.imagesUrl[r]=P},null,8,At),[[f,o.product.imagesUrl[r]]]),t("button",{class:"btn btn-outline-danger btn-sm d-block w-100",onClick:P=>o.product.imagesUrl.splice(r,1)}," 刪除圖片 ",8,wt)])])]))),128))]),t("div",It,[t("a",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[9]||(e[9]=()=>{o.product.imagesUrl.push("")})}," 新增圖片 "),Tt,Dt])])])],512)]),_:1})}const St=C(R,[["render",Rt]]);var Nt={VITE_APP_API_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_API_NAME:"ektodorwang-api",BASE_URL:"/ghibli-store/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:Lt,VITE_APP_API_NAME:Ot}=Nt,$t={data(){return{products:[],tempProduct:{},isCreateModal:!1,pagination:{},editModal:null,deleteModal:null}},methods:{openDeleteModal(d){this.tempProduct=JSON.parse(JSON.stringify(d)),this.deleteModal.show()},openEditModal(d,e={}){this.tempProduct=JSON.parse(JSON.stringify(e)),d==="edit"?this.isCreateModal=!1:this.isCreateModal=!0,this.editModal.show()},readProducts(d=1){const e=this.$loading.show();this.$http.get(`${Lt}/api/${Ot}/admin/products?page=${d}`).then(n=>{this.products=n.data.products,this.pagination=n.data.pagination,e.hide()}).catch(n=>{console.error(n.message),alert("讀取資料失敗")})}},components:{PaginationComponent:E,EditModalComponent:St,DeleteModalComponent:T},mounted(){this.readProducts()}},Bt={class:"table text-center align-middle"},Jt=t("thead",null,[t("tr",null,[t("th",null,"分類"),t("th",null,"產品圖片"),t("th",null,"產品名稱"),t("th",null,"原價"),t("th",null,"售價"),t("th",{width:"100"},"是否啟用"),t("th",{width:"120"},"編輯")])],-1),qt={class:"my-auto"},jt=["src"],Ft={class:"text-center"},zt={class:"text-center"},Gt={key:0,class:"text-success"},Ht={key:1},Kt={class:"btn-group"},Qt=["onClick"],Wt=["onClick"],Xt={class:"text-end mt-auto d-flex align-items-center"};function Yt(d,e,n,k,o,i){const m=_("PaginationComponent"),u=_("EditModalComponent"),v=_("DeleteModalComponent");return c(),p(M,null,[t("table",Bt,[Jt,t("tbody",null,[(c(!0),p(M,null,U(o.products,(s,l)=>(c(),p("tr",{key:l},[t("td",qt,g(s.category),1),t("td",null,[t("img",{style:{width:"50px"},src:s.imageUrl,alt:"image"},null,8,jt)]),t("td",null,g(s.title),1),t("td",Ft,g(s.origin_price),1),t("td",zt,g(s.price),1),t("td",null,[s.is_enabled?(c(),p("span",Gt,"啟用")):(c(),p("span",Ht,"未啟用"))]),t("td",null,[t("div",Kt,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:r=>i.openEditModal("edit",s)}," 編輯 ",8,Qt),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:r=>i.openDeleteModal(s)}," 刪除 ",8,Wt)])])]))),128))])]),t("div",Xt,[a(m,{pagination:o.pagination,onCurrentPage:i.readProducts},null,8,["pagination","onCurrentPage"]),t("button",{onClick:e[0]||(e[0]=s=>i.openEditModal("create")),class:"btn btn-primary ms-auto"},"建立新的產品")]),a(u,{onEditModal:e[1]||(e[1]=s=>o.editModal=s),tempProduct:o.tempProduct,"is-create-modal":o.isCreateModal,onReadProducts:i.readProducts},null,8,["tempProduct","is-create-modal","onReadProducts"]),a(v,{url:`product/${o.tempProduct.id}`,onDeleteModal:e[2]||(e[2]=s=>o.deleteModal=s),onReadData:i.readProducts},null,8,["url","onReadData"])],64)}const oe=C($t,[["render",Yt]]);export{oe as default};
