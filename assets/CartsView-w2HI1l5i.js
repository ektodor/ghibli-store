import{e as v,m as y,L as S,_ as x,r as h,o as r,c as m,b as e,n as _,F as C,g as P,h as g,t as u,d as $,k as N,f as q,l as B,a as l,j,w as F}from"./index-2BssBkm8.js";import{o as b}from"./ordersStore-wdSb9bhT.js";import{c as U}from"./couponsStore-ZZOfIIHM.js";const O={data(){return{fullPage:!0,coupon:"無優惠卷"}},methods:{...v(b,["getCartProducts","deleteAllProducts","deleteProduct","updateCartQuantity"]),...v(U,["useCoupon"])},computed:{...y(b,["cart","loading"]),...y(U,["coupons"])},watch:{async coupon(){await this.useCoupon(this.coupon),await this.getCartProducts()}},components:{Loading:S},emits:["loading"]},A={class:"table-responsive-lg"},E={class:"table align-middle"},L=e("thead",{class:"table-primary"},[e("tr",null,[e("th"),e("th",{class:"text-center"},"品名"),e("th",{class:"text-center",style:{width:"150px"}},"數量/單位"),e("th",null,"單價")])],-1),D={class:"table-group-divider"},M=["onClick"],Q=e("i",{class:"fas fa-spinner fa-pulse"},null,-1),T={class:"text-center"},z={class:"text-success"},G={class:"text-center"},H={class:"input-group input-group-sm"},I={class:"input-group mb-3"},J=["onUpdate:modelValue","onBlur"],K={class:"input-group-text",id:"basic-addon2"},R={class:"text-end"},W={class:"text-danger text-decoration-line-through"},X=e("br",null,null,-1),Y=e("small",{class:"text-success"},"折扣價：",-1),Z=e("td",{colspan:"3",class:"text-end"},null,-1),ee={class:"text-end",style:{"max-width":"100px"}},se=e("option",{selected:"",value:"無優惠卷",disabled:""},"請選擇搭配優惠卷",-1),te=["value"],oe=e("td",{colspan:"3",class:"text-end"},"總計",-1),ne={class:"text-end"},le=e("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),ae={class:"text-end text-success"};function de(o,t,V,k,n,f){var a,p;const c=h("loading");return r(),m(C,null,[e("div",null,[e("button",{onClick:t[0]||(t[0]=(...s)=>o.deleteAllProducts&&o.deleteAllProducts(...s)),class:_(["btn btn-danger mb-3",{disabled:!((p=(a=o.cart)==null?void 0:a.carts)!=null&&p.length)}]),type:"button"}," 清空購物車 ",2),e("div",A,[e("table",E,[L,e("tbody",D,[o.cart.carts?(r(!0),m(C,{key:0},P(o.cart.carts,s=>(r(),m("tr",{key:s.id},[e("td",null,[e("button",{onClick:i=>o.deleteProduct(s.id),type:"button",class:"btn btn-outline-danger btn-sm"},[Q,g(" x ")],8,M)]),e("td",T,[g(u(s.product.title)+" ",1),e("div",z,u(n.coupon!="無優惠卷"?"已套用優惠券":"尚未套用優惠卷"),1)]),e("td",G,[e("div",H,[e("div",I,[$(e("input",{"onUpdate:modelValue":i=>s.qty=i,min:"1",type:"number",class:"form-control",onBlur:i=>o.updateCartQuantity(s.id,s.product.id,s.qty)},null,40,J),[[N,s.qty,void 0,{number:!0}]]),e("span",K,u(s.product.unit),1)])])]),e("td",R,[e("small",W,"原價："+u(s.total),1),X,Y,g(" "+u(s.final_total),1)])]))),128)):q("",!0)]),e("tfoot",null,[e("tr",null,[Z,e("td",ee,[$(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>n.coupon=s),class:"form-control border-3 border",id:"coupons"},[se,(r(!0),m(C,null,P(o.coupons,s=>(r(),m("option",{key:s,value:s},u(s),9,te))),128))],512),[[B,n.coupon]])])]),e("tr",null,[oe,e("td",ne,u(o.cart.total),1)]),e("tr",null,[le,e("td",ae,u(o.cart.final_total),1)])])])])]),l(c,{active:o.loading,"onUpdate:active":t[2]||(t[2]=s=>o.loading=s),"is-full-page":n.fullPage},null,8,["active","is-full-page"])],64)}const re=x(O,[["render",de]]),ce={data(){return{user:{name:"",email:"",tel:"",address:""},message:""}},computed:{...y(b,["cart"])},methods:{...v(b,["checkoutProducts"]),sendOrder(){this.checkoutProducts(this.user,this.message),this.user={name:"",email:"",tel:"",address:""},this.message=""},isPhone(o){return/^(09)[0-9]{8}$/.test(o)?!0:"需要正確的電話號碼"}}},ie={class:"mb-3"},ue=e("label",{for:"email",class:"form-label"},"Email",-1),me={class:"mb-3"},pe=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),_e={class:"mb-3"},he=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),be={class:"mb-3"},fe=e("label",{for:"address",class:"form-label"},"收件人地址",-1),ge={class:"mb-3"},ve=e("label",{for:"message",class:"form-label"},"留言",-1),ye={class:"text-end"};function Ce(o,t,V,k,n,f){const c=h("v-field"),a=h("error-message"),p=h("v-form");return r(),j(p,{ref:"form",onSubmit:f.sendOrder},{default:F(({errors:s})=>{var i,w;return[e("div",ie,[ue,l(c,{id:"email",name:"email",type:"email",class:_(["form-control",{"is-invalid":s.email}]),rules:"email|required",placeholder:"請輸入 Email",modelValue:n.user.email,"onUpdate:modelValue":t[0]||(t[0]=d=>n.user.email=d)},null,8,["class","modelValue"]),l(a,{name:"email",class:"invalid-feedback"})]),e("div",me,[pe,l(c,{id:"name",name:"姓名",type:"text",class:_(["form-control",{"is-invalid":s.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:n.user.name,"onUpdate:modelValue":t[1]||(t[1]=d=>n.user.name=d)},null,8,["class","modelValue"]),l(a,{name:"姓名",class:"invalid-feedback"})]),e("div",_e,[he,l(c,{id:"tel",name:"電話",type:"tel",class:_(["form-control",{"is-invalid":s.電話}]),placeholder:"請輸入電話",rules:f.isPhone,modelValue:n.user.tel,"onUpdate:modelValue":t[2]||(t[2]=d=>n.user.tel=d)},null,8,["class","rules","modelValue"]),l(a,{name:"電話",class:"invalid-feedback"})]),e("div",be,[fe,l(c,{id:"address",name:"地址",type:"text",class:_(["form-control",{"is-invalid":s.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:n.user.address,"onUpdate:modelValue":t[3]||(t[3]=d=>n.user.address=d)},null,8,["class","modelValue"]),l(a,{name:"地址",class:"invalid-feedback"})]),e("div",ge,[ve,$(e("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":t[4]||(t[4]=d=>n.message=d)},null,512),[[N,n.message]])]),e("div",ye,[e("button",{type:"submit",class:_(["btn btn-danger",{disabled:!((w=(i=o.cart)==null?void 0:i.carts)!=null&&w.length)}])}," 送出訂單 ",2)])]}),_:1},8,["onSubmit"])}const $e=x(ce,[["render",Ce]]),xe={computed:{...y(b,["cart"])},methods:{...v(b,["getCartProducts"])},components:{FrontOrderComponent:re,ClientComponent:$e},mounted(){this.getCartProducts()}},Ve={class:"container-lg h-100"},ke={key:0,class:"row my-2 p-lg-5 p-1 rounded-3 justify-content-center justify-content-lg-between"},we={class:"text-end col-lg-6"},Pe={class:"col-lg-5 row justify-content-center bg-success p-3 rounded-3"},Ue={key:1,class:"h-100 d-flex justify-content-center align-items-center"},Ne={class:"bg-success bg-opacity-50 p-5 rounded-3 text-center"},Se=e("h2",{class:"text-danger fw-bold"},"目前購物車為空",-1),qe=e("i",{class:"bi bi-cursor me-2"},null,-1);function Be(o,t,V,k,n,f){var p,s;const c=h("FrontOrderComponent"),a=h("ClientComponent");return r(),m("div",Ve,[((s=(p=o.cart)==null?void 0:p.carts)==null?void 0:s.length)>0?(r(),m("div",ke,[e("div",we,[l(c,{onNextProcess:t[0]||(t[0]=i=>o.process=o.process+i)})]),e("div",Pe,[l(a)])])):(r(),m("div",Ue,[e("div",Ne,[Se,e("button",{class:"btn btn-warning w-100 mt-3 fs-5",onClick:t[1]||(t[1]=()=>o.$router.push("/products"))},[qe,g("查看片單 ")])])]))])}const Ae=x(xe,[["render",Be]]);export{Ae as default};
