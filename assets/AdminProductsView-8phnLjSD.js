import{_ as v,o as n,c,b as t,n as p,F as P,g as A,t as h,M as x,r as b,h as C,w as U,d as g,i as f,a as r,v as $,f as I}from"./index-nZ-bWd1c.js";const w={props:["pagination"],methods:{changePage(a){this.$emit("current-page",a)}}},T={"aria-label":"Page navigation example"},R={class:"pagination m-0"},L=t("span",{"aria-hidden":"true"},"«",-1),D=[L],N={key:0,class:"page-link active"},S=["onClick"],O=t("span",{"aria-hidden":"true"},"»",-1),B=[O];function q(a,e,u,M,o,i){return n(),c("nav",T,[t("ul",R,[t("li",{class:p(["page-item",{disabled:!u.pagination.has_pre}])},[t("a",{class:"page-link",style:{cursor:"pointer"},"aria-label":"Previous",onClick:e[0]||(e[0]=d=>i.changePage(u.pagination.current_page-1))},D)],2),(n(!0),c(P,null,A(u.pagination.total_pages,d=>(n(),c("li",{key:d,class:"page-item"},[d===u.pagination.current_page?(n(),c("span",N,h(d),1)):(n(),c("span",{key:1,class:"page-link",style:{cursor:"pointer"},onClick:m=>i.changePage(d)},h(d),9,S))]))),128)),t("li",{class:p(["page-item",{disabled:!u.pagination.has_next}])},[t("a",{class:"page-link",style:{cursor:"pointer"},"aria-label":"Next",onClick:e[1]||(e[1]=d=>i.changePage(u.pagination.current_page+1))},B)],2)])])}const J=v(w,[["render",q]]);var F={VITE_APP_API_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_API_NAME:"ektodorwang-api",BASE_URL:"/ghibli-store/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:k,VITE_APP_API_NAME:E}=F,j={data(){return{product:{},editModal:null}},methods:{openModal(){this.editModal.show()},createPrdouct(){this.product.imagesUrl=this.product.imagesUrl.filter(a=>a!==""),this.$http.post(`${k}/api/${E}/admin/product`,{data:this.product}).then(()=>{this.$emit("read-products"),this.editModal.hide(),this.imgModal.hide()}).catch(a=>{console.error(a.message),alert("新增失敗")})},updatePrdouct(){this.$http.put(`${k}/api/${E}/admin/product/${this.tempProduct.id}`,{data:this.product}).then(()=>{this.$emit("read-products"),this.editModal.hide(),this.imgModal.hide()}).catch(a=>{console.error(a.message),alert("更新失敗")})}},watch:{tempProduct(){this.product=JSON.parse(JSON.stringify(this.tempProduct)),this.product.imagesUrl||(this.product.imagesUrl=[])}},props:["tempProduct","isCreateModal"],emits:["edit-modal","read-products"],mounted(){this.editModal=new x(this.$refs.editModal),this.imgModal=new x(this.$refs.imgModal),this.$emit("edit-modal",this.editModal)}},z={ref:"editModal",class:"modal fade",id:"exampleModalToggle","aria-hidden":"true","aria-labelledby":"exampleModalToggleLabel",tabindex:"-1"},G={class:"modal-dialog modal-dialog-centered modal-lg"},H={class:"modal-content"},K={class:"modal-header bg-secondary"},Q={class:"modal-title fs-5",id:"exampleModalToggleLabel"},W=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),X={class:"modal-body"},Y={class:"card mb-3 m-auto",style:{"max-width":"540px"}},Z={class:"row g-0"},tt={class:"col-md-4"},et=["src"],ot={class:"col-md-8"},st={class:"card-body"},lt=t("h5",{class:"card-title"},"主要圖片",-1),at=t("label",{for:"imageUrl",class:"form-label card-text"},[t("small",{class:"text-muted"},"輸入圖片網址")],-1),dt={class:"mb-3"},it=t("label",{for:"title",class:"form-label"},"標題",-1),nt={class:"row"},rt={class:"mb-3 col-md-6"},ct=t("label",{for:"category",class:"form-label"},"分類",-1),ut={class:"mb-3 col-md-6"},mt=t("label",{for:"price",class:"form-label"},"單位",-1),_t={class:"row"},pt={class:"mb-3 col-md-6"},ht=t("label",{for:"origin_price",class:"form-label"},"原價",-1),bt={class:"mb-3 col-md-6"},gt=t("label",{for:"price",class:"form-label"},"售價",-1),ft=t("hr",null,null,-1),Pt={class:"mb-3"},vt=t("label",{for:"description",class:"form-label"},"產品描述",-1),Mt={class:"mb-3"},yt=t("label",{for:"content",class:"form-label"},"說明內容",-1),xt={class:"mb-3"},At={class:"form-check"},Vt=t("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),kt=t("div",{class:"modal-footer"},[t("a",{class:"btn btn-primary","data-bs-target":"#exampleModalToggle2","data-bs-toggle":"modal"}," 編輯圖片 ")],-1),Et={ref:"imgModal",class:"modal fade",id:"exampleModalToggle2","aria-hidden":"true","aria-labelledby":"exampleModalToggleLabel2",tabindex:"-1"},Ct={class:"modal-dialog modal-dialog-centered modal-lg"},Ut={class:"modal-content"},$t=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"exampleModalToggleLabel2"},"圖片編輯"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),It={class:"modal-body d-flex flex-wrap justify-content-evenly"},wt={class:"row g-0"},Tt=["src"],Rt={class:"card-body"},Lt=t("h5",{class:"card-title"},"補充圖片",-1),Dt=["for"],Nt=t("small",{class:"text-muted"},"輸入圖片網址",-1),St=[Nt],Ot=["id","onUpdate:modelValue"],Bt=["onClick"],qt={class:"modal-footer"},Jt=t("a",{class:"btn btn-primary","data-bs-target":"#exampleModalToggle","data-bs-toggle":"modal"}," 返回 ",-1),Ft=t("button",{type:"submit",class:"btn btn-primary"},"儲存資料",-1);function jt(a,e,u,M,o,i){const d=b("v-field"),m=b("error-message"),y=b("v-form");return n(),C(y,{onSubmit:e[10]||(e[10]=l=>u.isCreateModal?i.createPrdouct():i.updatePrdouct())},{default:U(({errors:l})=>[t("div",z,[t("div",G,[t("div",H,[t("div",K,[t("h1",Q,h(u.isCreateModal?"新增產品":"編輯產品"),1),W]),t("div",X,[t("div",Y,[t("div",Z,[t("div",tt,[t("img",{src:o.product.imageUrl,class:"img-fluid rounded-start",alt:"photo"},null,8,et)]),t("div",ot,[t("div",st,[lt,at,g(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":e[0]||(e[0]=s=>o.product.imageUrl=s)},null,512),[[f,o.product.imageUrl]])])])])]),t("div",dt,[it,r(d,{id:"title",name:"標題",rules:"required",class:p([{"is-invalid":l.標題},"form-control"]),type:"text",placeholder:"請輸入標題",modelValue:o.product.title,"onUpdate:modelValue":e[1]||(e[1]=s=>o.product.title=s)},null,8,["class","modelValue"]),r(m,{name:"標題",class:"invalid-feedback"})]),t("div",nt,[t("div",rt,[ct,r(d,{id:"category",name:"分類",rules:"required",class:p([{"is-invalid":l.分類},"form-control"]),type:"text",placeholder:"請輸入分類",modelValue:o.product.category,"onUpdate:modelValue":e[2]||(e[2]=s=>o.product.category=s)},null,8,["class","modelValue"]),r(m,{name:"分類",class:"invalid-feedback"})]),t("div",ut,[mt,r(d,{id:"unit",name:"單位",rules:"required",class:p([{"is-invalid":l.單位},"form-control"]),type:"text",placeholder:"請輸入單位",modelValue:o.product.unit,"onUpdate:modelValue":e[3]||(e[3]=s=>o.product.unit=s)},null,8,["class","modelValue"]),r(m,{name:"單位",class:"invalid-feedback"})])]),t("div",_t,[t("div",pt,[ht,r(d,{id:"origin_price",name:"原價",rules:"required",class:p([{"is-invalid":l.原價},"form-control"]),type:"number",min:"0",placeholder:"請輸入原價",modelValue:o.product.origin_price,"onUpdate:modelValue":e[4]||(e[4]=s=>o.product.origin_price=s),modelModifiers:{number:!0}},null,8,["class","modelValue"]),r(m,{name:"原價",class:"invalid-feedback"})]),t("div",bt,[gt,r(d,{id:"price",name:"售價",rules:"required",class:p([{"is-invalid":l.售價},"form-control"]),type:"number",min:"0",placeholder:"請輸入售價",modelValue:o.product.price,"onUpdate:modelValue":e[5]||(e[5]=s=>o.product.price=s),modelModifiers:{number:!0}},null,8,["class","modelValue"]),r(m,{name:"售價",class:"invalid-feedback"})])]),ft,t("div",Pt,[vt,g(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入產品描述","onUpdate:modelValue":e[6]||(e[6]=s=>o.product.description=s)},`
              `,512),[[f,o.product.description]])]),t("div",Mt,[yt,g(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入說明內容","onUpdate:modelValue":e[7]||(e[7]=s=>o.product.content=s)},`
              `,512),[[f,o.product.content]])]),t("div",xt,[t("div",At,[g(t("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":e[8]||(e[8]=s=>o.product.is_enabled=s)},null,512),[[$,o.product.is_enabled]]),Vt])])]),kt])])],512),t("div",Et,[t("div",Ct,[t("div",Ut,[$t,t("div",It,[(n(!0),c(P,null,A(o.product.imagesUrl,(s,_)=>(n(),c("div",{class:"card mb-3",style:{width:"350px"},key:_},[t("div",wt,[t("img",{style:{"min-height":"200px"},src:s,class:"card-img-top",alt:"photo"},null,8,Tt),t("div",Rt,[Lt,t("label",{for:"補充圖片-"+(_+1),class:"form-label card-text"},St,8,Dt),g(t("input",{id:"補充圖片-"+(_+1),type:"text",class:"form-control mb-2",placeholder:"請輸入圖片連結","onUpdate:modelValue":V=>o.product.imagesUrl[_]=V},null,8,Ot),[[f,o.product.imagesUrl[_]]]),t("button",{class:"btn btn-outline-danger btn-sm d-block w-100",onClick:V=>o.product.imagesUrl.splice(_,1)}," 刪除圖片 ",8,Bt)])])]))),128))]),t("div",qt,[t("a",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[9]||(e[9]=()=>{o.product.imagesUrl.push("")})}," 新增圖片 "),Jt,Ft])])])],512)]),_:1})}const zt=v(j,[["render",jt]]);var Gt={VITE_APP_API_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_API_NAME:"ektodorwang-api",BASE_URL:"/ghibli-store/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:Ht,VITE_APP_API_NAME:Kt}=Gt,Qt={data(){return{modal:null}},props:["tempProduct"],emits:["delete-modal","read-products"],methods:{deletePrdouct(){this.$http.delete(`${Ht}/api/${Kt}/admin/product/${this.tempProduct.id}`).then(()=>{this.$emit("read-products"),this.modal.hide()}).catch(a=>{console.error(a.message),alert("刪除資料失敗")})}},mounted(){this.modal=new x(this.$refs.delProductModal),this.$emit("delete-modal",this.modal)}},Wt={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},Xt={class:"modal-dialog"},Yt={class:"modal-content border-0"},Zt=I('<div class="modal-header bg-danger text-white"><h5 id="delProductModalLabel" class="modal-title"><span>刪除產品</span></h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"> 是否刪除 <strong class="text-danger"></strong> 商品(刪除後將無法恢復)。 </div>',2),te={class:"modal-footer"},ee=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function oe(a,e,u,M,o,i){return n(),c("div",Wt,[t("div",Xt,[t("div",Yt,[Zt,t("div",te,[ee,t("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=(...d)=>i.deletePrdouct&&i.deletePrdouct(...d))},"確認刪除")])])])],512)}const se=v(Qt,[["render",oe]]);var le={VITE_APP_API_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_API_NAME:"ektodorwang-api",BASE_URL:"/ghibli-store/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:ae,VITE_APP_API_NAME:de}=le,ie={data(){return{products:[],tempProduct:{},isCreateModal:!1,pagination:{},editModal:null,deleteModal:null}},methods:{openDeleteModal(a){this.tempProduct=a,this.deleteModal.show()},openEditModal(a,e={}){this.tempProduct=JSON.parse(JSON.stringify(e)),a==="edit"?this.isCreateModal=!1:this.isCreateModal=!0,this.editModal.show()},readProducts(a=1){this.$http.get(`${ae}/api/${de}/admin/products?page=${a}`).then(e=>{this.products=e.data.products,this.pagination=e.data.pagination}).catch(e=>{console.error(e.message),alert("讀取資料失敗")})}},components:{PaginationComponent:J,EditModalComponent:zt,DeleteModalComponent:se},mounted(){this.readProducts()}},ne={class:"table text-center align-middle"},re=t("thead",null,[t("tr",null,[t("th",null,"分類"),t("th",null,"產品圖片"),t("th",null,"產品名稱"),t("th",null,"原價"),t("th",null,"售價"),t("th",{width:"100"},"是否啟用"),t("th",{width:"120"},"編輯")])],-1),ce={class:"my-auto"},ue=["src"],me={class:"text-center"},_e={class:"text-center"},pe={key:0,class:"text-success"},he={key:1},be={class:"btn-group"},ge=["onClick"],fe=["onClick"],Pe={class:"text-end mt-auto d-flex align-items-center"};function ve(a,e,u,M,o,i){const d=b("PaginationComponent"),m=b("EditModalComponent"),y=b("DeleteModalComponent");return n(),c(P,null,[t("table",ne,[re,t("tbody",null,[(n(!0),c(P,null,A(o.products,(l,s)=>(n(),c("tr",{key:s},[t("td",ce,h(l.category),1),t("td",null,[t("img",{style:{width:"50px"},src:l.imageUrl,alt:"image"},null,8,ue)]),t("td",null,h(l.title),1),t("td",me,h(l.origin_price),1),t("td",_e,h(l.price),1),t("td",null,[l.is_enabled?(n(),c("span",pe,"啟用")):(n(),c("span",he,"未啟用"))]),t("td",null,[t("div",be,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:_=>i.openEditModal("edit",l)}," 編輯 ",8,ge),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:_=>i.openDeleteModal(l)}," 刪除 ",8,fe)])])]))),128))])]),t("div",Pe,[r(d,{pagination:o.pagination,onCurrentPage:i.readProducts},null,8,["pagination","onCurrentPage"]),t("button",{onClick:e[0]||(e[0]=l=>i.openEditModal("create")),class:"btn btn-primary ms-auto"},"建立新的產品")]),r(m,{onEditModal:e[1]||(e[1]=l=>o.editModal=l),tempProduct:o.tempProduct,"is-create-modal":o.isCreateModal,onReadProducts:i.readProducts},null,8,["tempProduct","is-create-modal","onReadProducts"]),r(y,{tempProduct:o.tempProduct,onDeleteModal:e[2]||(e[2]=l=>o.deleteModal=l),onReadProducts:i.readProducts},null,8,["tempProduct","onReadProducts"])],64)}const ye=v(ie,[["render",ve]]);export{ye as default};
