import{e as v,m as y,L as q,_ as k,r as h,o as c,c as u,b as e,d as $,l as B,t as r,F as C,g as P,n as _,j as g,h as S,f as N,a as n,k as j,w as F}from"./index-2a5Nf4DG.js";import{o as b}from"./ordersStore-i-HjApLS.js";import{c as U}from"./couponsStore-a4vnHWJ0.js";const O={data(){return{fullPage:!0,coupon:"無優惠卷"}},methods:{...v(b,["getCartProducts","deleteAllProducts","deleteProduct","updateCartQuantity"]),...v(U,["useCoupon"])},computed:{...y(b,["cart","loading"]),...y(U,["coupons"])},watch:{async coupon(){await this.useCoupon(this.coupon),await this.getCartProducts()}},components:{Loading:q},emits:["loading"]},A={class:"d-flex align-items-center my-3"},E=["disabled"],L={selected:"",value:"無優惠卷",disabled:""},D=["value"],M=e("small",{class:"text-danger align-self-end ms-2"},"優惠卷可以至消息內容中領取!!!",-1),Q={class:"table-responsive-lg border-black border"},T={class:"table align-middle"},z=e("thead",{class:"table-primary"},[e("tr",null,[e("th"),e("th",{class:"text-center"},"品名"),e("th",{class:"text-center",style:{width:"150px"}},"數量/單位"),e("th",null,"單價")])],-1),G={class:"table-group-divider"},H=["onClick"],I=e("i",{class:"fas fa-spinner fa-pulse"},null,-1),J={class:"text-center"},K={class:"text-success"},R={class:"text-center"},W={class:"input-group input-group-sm"},X={class:"input-group mb-3"},Y=["onUpdate:modelValue","onBlur"],Z={class:"input-group-text",id:"basic-addon2"},ee={class:"text-end"},te={class:"text-danger text-decoration-line-through"},se=e("br",null,null,-1),oe=e("small",{class:"text-success"},"折扣價：",-1),le=e("td",{colspan:"3",class:"text-end"},"總計",-1),ne={class:"text-end"},ae=e("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),de={class:"text-end text-success"};function re(s,o,V,x,l,f){var a,m;const i=h("loading");return c(),u(C,null,[e("div",null,[e("div",A,[$(e("select",{disabled:s.cart.total!=s.cart.final_total,"onUpdate:modelValue":o[0]||(o[0]=t=>l.coupon=t),class:"form-control border-3 border w-50",style:{"max-width":"200px"},id:"coupons"},[e("option",L,r(s.cart.total==s.cart.final_total?"請選擇搭配優惠卷":"已使用過優惠卷"),1),(c(!0),u(C,null,P(s.coupons,t=>(c(),u("option",{key:t,value:t},r(t),9,D))),128))],8,E),[[B,l.coupon]]),M,e("button",{onClick:o[1]||(o[1]=(...t)=>s.deleteAllProducts&&s.deleteAllProducts(...t)),class:_(["btn btn-danger ms-auto",{disabled:!((m=(a=s.cart)==null?void 0:a.carts)!=null&&m.length)}]),type:"button"}," 清空購物車 ",2)]),e("div",Q,[e("table",T,[z,e("tbody",G,[s.cart.carts?(c(!0),u(C,{key:0},P(s.cart.carts,t=>(c(),u("tr",{key:t.id},[e("td",null,[e("button",{onClick:p=>s.deleteProduct(t.id),type:"button",class:"btn btn-outline-danger btn-sm"},[I,g(" x ")],8,H)]),e("td",J,[g(r(t.product.title)+" ",1),e("div",K,r(t.total!=t.final_total?"已套用優惠券":"尚未套用優惠卷"),1)]),e("td",R,[e("div",W,[e("div",X,[$(e("input",{"onUpdate:modelValue":p=>t.qty=p,min:"1",type:"number",class:"form-control",onBlur:p=>s.updateCartQuantity(t.id,t.product.id,t.qty)},null,40,Y),[[S,t.qty,void 0,{number:!0}]]),e("span",Z,r(t.product.unit),1)])])]),e("td",ee,[e("small",te,"原價："+r(t.total),1),se,oe,g(" "+r(t.final_total),1)])]))),128)):N("",!0)]),e("tfoot",null,[e("tr",null,[le,e("td",ne,r(s.cart.total),1)]),e("tr",null,[ae,e("td",de,r(s.cart.final_total),1)])])])])]),n(i,{active:s.loading,"onUpdate:active":o[2]||(o[2]=t=>s.loading=t),"is-full-page":l.fullPage},null,8,["active","is-full-page"])],64)}const ce=k(O,[["render",re]]),ie={data(){return{user:{name:"",email:"",tel:"",address:""},message:""}},computed:{...y(b,["cart"])},methods:{...v(b,["checkoutProducts"]),sendOrder(){this.checkoutProducts(this.user,this.message),this.user={name:"",email:"",tel:"",address:""},this.message=""},isPhone(s){return/^(09)[0-9]{8}$/.test(s)?!0:"需要正確的電話號碼"}}},ue={class:"mb-3"},me=e("label",{for:"email",class:"form-label"},"Email",-1),pe={class:"mb-3"},_e=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),he={class:"mb-3"},be=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),fe={class:"mb-3"},ge=e("label",{for:"address",class:"form-label"},"收件人地址",-1),ve={class:"mb-3"},ye=e("label",{for:"message",class:"form-label"},"留言",-1),Ce={class:"text-end"};function $e(s,o,V,x,l,f){const i=h("v-field"),a=h("error-message"),m=h("v-form");return c(),j(m,{ref:"form",onSubmit:f.sendOrder},{default:F(({errors:t})=>{var p,w;return[e("div",ue,[me,n(i,{id:"email",name:"email",type:"email",class:_(["form-control",{"is-invalid":t.email}]),rules:"email|required",placeholder:"請輸入 Email",modelValue:l.user.email,"onUpdate:modelValue":o[0]||(o[0]=d=>l.user.email=d)},null,8,["class","modelValue"]),n(a,{name:"email",class:"invalid-feedback"})]),e("div",pe,[_e,n(i,{id:"name",name:"姓名",type:"text",class:_(["form-control",{"is-invalid":t.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:l.user.name,"onUpdate:modelValue":o[1]||(o[1]=d=>l.user.name=d)},null,8,["class","modelValue"]),n(a,{name:"姓名",class:"invalid-feedback"})]),e("div",he,[be,n(i,{id:"tel",name:"電話",type:"tel",class:_(["form-control",{"is-invalid":t.電話}]),placeholder:"請輸入電話",rules:f.isPhone,modelValue:l.user.tel,"onUpdate:modelValue":o[2]||(o[2]=d=>l.user.tel=d)},null,8,["class","rules","modelValue"]),n(a,{name:"電話",class:"invalid-feedback"})]),e("div",fe,[ge,n(i,{id:"address",name:"地址",type:"text",class:_(["form-control",{"is-invalid":t.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:l.user.address,"onUpdate:modelValue":o[3]||(o[3]=d=>l.user.address=d)},null,8,["class","modelValue"]),n(a,{name:"地址",class:"invalid-feedback"})]),e("div",ve,[ye,$(e("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":o[4]||(o[4]=d=>l.message=d)},null,512),[[S,l.message]])]),e("div",Ce,[e("button",{type:"submit",class:_(["btn btn-primary",{disabled:!((w=(p=s.cart)==null?void 0:p.carts)!=null&&w.length)}])}," 送出訂單 ",2)])]}),_:1},8,["onSubmit"])}const ke=k(ie,[["render",$e]]),Ve={computed:{...y(b,["cart"])},methods:{...v(b,["getCartProducts"])},components:{FrontOrderComponent:ce,ClientComponent:ke},mounted(){this.getCartProducts()}},xe={class:"container h-100"},we={key:0,class:"row my-2 p-lg-5 p-1 rounded-3 justify-content-center justify-content-lg-between"},Pe={class:"text-end p-0 col-lg-6"},Ue={class:"col-lg-5 row justify-content-center p-4 my-4 border-black border rounded-3"},Se={key:1,class:"h-100 d-flex justify-content-center align-items-center"},qe={class:"border p-4 mb-4"},Be=e("h2",{class:"text-danger fw-bold"},"目前購物車為空",-1),Ne=e("hr",{class:"my-4"},null,-1),je=e("i",{class:"bi bi-cursor me-2"},null,-1);function Fe(s,o,V,x,l,f){var m,t;const i=h("FrontOrderComponent"),a=h("ClientComponent");return c(),u("div",xe,[((t=(m=s.cart)==null?void 0:m.carts)==null?void 0:t.length)>0?(c(),u("div",we,[e("div",Pe,[n(i)]),e("div",Ue,[n(a)])])):(c(),u("div",Se,[e("div",qe,[Be,Ne,e("button",{class:"btn btn-primary w-100",onClick:o[0]||(o[0]=()=>s.$router.push("/products"))},[je,g("查看片單 ")])])]))])}const Le=k(Ve,[["render",Fe]]);export{Le as default};
