import{p as n,q as s}from"./index-CT0q0FpJ.js";import{S as r}from"./sweetalert2.all-D-4Y_zWQ.js";var d={VITE_APP_API_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_API_NAME:"ektodorwang-api",BASE_URL:"/ghibli-store/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:i,VITE_APP_API_NAME:c}=d,u=n("ordersStore",{state:()=>({cart:[],loading:null}),actions:{async addProduct(t,e=1,a=null){await s.post(`${i}/api/${c}/cart`,{data:{product_id:t,qty:e}}).then(async()=>{await this.getCartProducts(),r.fire({title:"恭喜!",text:"購物車更新成功",icon:"success"}),a&&a.hide()}).catch(o=>{this.errorMessage(o,"加入購物車失敗")})},async getCartProducts(){this.loading=!0,await s.get(`${i}/api/${c}/cart`).then(t=>{this.cart=JSON.parse(JSON.stringify(t.data.data)),this.loading=!1}).catch(t=>{this.errorMessage(t,"取得購物車列表失敗")})},async deleteProduct(t){this.loading=!0,await s.delete(`${i}/api/${c}/cart/${t}`).then(async()=>{await this.getCartProducts(),this.loading=!1,r.fire({title:"恭喜!",text:"購物車更新成功",icon:"success"})}).catch(e=>{this.errorMessage(e,"刪除購物車項目失敗 (單一)")})},async deleteAllProducts(){this.loading=!0,await s.delete(`${i}/api/${c}/carts`).then(async()=>{await this.getCartProducts(),this.loading=!1,r.fire({title:"恭喜!",text:"購物車更新成功",icon:"success"})}).catch(t=>{this.errorMessage(t,"刪除購物車項目失敗 (全部)")})},async updateCartQuantity(t,e,a){this.loading=!0,await s.put(`${i}/api/${c}/cart/${t}`,{data:{product_id:e,qty:a}}).then(async()=>{await this.getCartProducts(),this.loading=!1,r.fire({title:"恭喜!",text:"購物車更新成功",icon:"success"})}).catch(o=>{this.errorMessage(o,"更改產品數量失敗")})},async checkoutProducts(t,e){this.loading=!0,await s.post(`${i}/api/${c}/order`,{data:{user:t,message:e}}).then(async()=>{await this.getCartProducts(),r.fire({title:"恭喜!",text:"商品已完成結帳",icon:"success"})}).catch(a=>{this.errorMessage(a,"結帳失敗")})},errorMessage(t,e){r.fire({title:"失敗!",text:e,icon:"success"})}},getters:{getOrdersNum({cart:t}){var e;return(e=t.carts)==null?void 0:e.length}}});export{u as o};
